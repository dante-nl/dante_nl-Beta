<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:description" content="Custime is a customisable time viewer, with different backgrounds, fonts and the ability to switch from 24 hour time to 12 hour time!">
	<link rel="stylesheet" href="style.css">
	<script src="https://kit.fontawesome.com/ee422b4c3c.js" crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
	<script type='text/javascript' src='https://cdn.dantenl.tk/tinycolor.js'></script>
	<script>
		// document.querySelector('meta[name="og:description"]').setAttribute(`content! Current Hour: ${CurrentHour}`, _desc);
		// ^ Make it work! Has to say things such as time, background color and font if they're set, otherwise a default description
	</script>
	<title>Custime</title>
</head>
<body onload="load()">
	<div class="clock">
		<h1><a href="javascript:changeFont()" id="time"><div class="spinner">
			<div class="rect1"></div>
			<div class="rect2"></div>
			<div class="rect3"></div>
			<div class="rect4"></div>
			<div class="rect5"></div>
		</div></a><p class="icon tooltip" id="date"><span id="dateContent">DD/MM/YY</span> <span class="tooltiptext">DD/MM/YY</span></p></h1>
		
	</div>
	<p id="copyConfirm" class="hideText pill">Copied URL! <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span></p>
	<h1>
		<div style="display:flex;justify-content:center;align-items:center;">
			<a id="clock" href="javascript:changeTimeFormat()" class="far fa-clock fa-sm icon"></a>

			<a href="javascript:changeColor('red')" style="background-color: #FFADAD" class="circle"></a>
			<a href="javascript:changeColor('yellow')" style="background-color: #FDFFB6" class="circle"></a>
			<a href="javascript:changeColor('green')" style="background-color: #CAFFBF" class="circle"></a>
			<a href="javascript:changeColor('blue')" style="background-color: #A0C4FF" class="circle"></a>
			<a href="javascript:changeColor('white')" style="background-color: #fff" class="circle"></a>

			<a id="share" href="javascript:share()" class="fas fa-share-alt fa-sm icon"></a>
		</div>
	</h1>
	<div style="font-family: Arial, sans-serif; padding: 20px; background-color: #7289da; color: #fff; border-radius: 8px">
		<strong>Hey!</strong> Currently you're visiting a page that is being worked on! So not everything might work
		properly! <i>This text is not part of the page, and is just directly pasted on top of it)</i>

	<script>
		function load() {
			if (/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
				// Mobile device
				console.log("Hey mobile user! You get the special VIP treatment with some cool new styles")
				document.body.classList.add("mobile")
			} else {
				// Not mobile
				console.log("Hey desktop/laptop user! You get the regular treatment with regular styles D: At least you get to see how this website is intended to be viewed")
				document.body.classList.remove("mobile")
			}
			AM_PM = false
			now = new Date()
			CurrentHour = now.getHours()
			CurrentMinute = now.getMinutes()
			CurrentSecond = now.getSeconds()
			const TimeUpdate = setInterval(Time, 1000);
			const DateUpdate = setInterval(UpdateDay, 1000);
			font = 0
			// BaseURL = "https://custime.dantenl.tk"
			// BaseURL = "http://127.0.0.1:5500/index.html"
			BaseURL = "http://beta.dantenl.tk"
			color = "white"
			LoadStyles()
		}

		function LoadStyles() {
			const queryString = new URLSearchParams(window.location.search)
			const loadTime = queryString.get('time')
			if (loadTime == "12") {
				AM_PM = true
				document.getElementById("clock").classList.remove('far')
				document.getElementById("clock").classList.add('fas')
				Time()
				console.log("Now showing 12 hour time format!")
			} else {
				AM_PM = false
				document.getElementById("clock").classList.add('far')
				document.getElementById("clock").classList.remove('fas')
				Time()
				console.log("Now showing 24 hour time format!")
			}
			const loadBG = queryString.get('bg')
			if (loadBG == "r") {
				color = "red"
				document.body.classList.add("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Changed style to red!")
			} else if (loadBG == "y") {
				color = "yellow"
				document.body.classList.remove("red")
				document.body.classList.add("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Changed style to yellow!")
			} else if (loadBG == "g") {
				color = "green"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.add("green")
				document.body.classList.remove("blue")
				console.log("Changed style to green!")
			} else if (loadBG == "b") {
				color = "blue"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.add("blue")
				console.log("Changed style to blue!")
			} else {
				color = "white"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Default style!")
			}
			const loadFont = queryString.get('font') 
			if (loadFont == "SS") {
				document.getElementById("time").style.fontFamily = "Smooch Sans, sans-serif"
				document.getElementById("date").style.fontFamily = "Smooch Sans, sans-serif"
				console.log("Font is now Smooch Sans")
				font = 1
			} else if (loadFont == "PD") {
				document.getElementById("time").style.fontFamily = "Playfair Display, sans-serif"
				document.getElementById("date").style.fontFamily = "Playfair Display, sans-serif"
				console.log("Font is now Playfair Display")
				font = 2
			} else if (loadFont == "Av") {
				document.getElementById("time").style.fontFamily = "Arvo, serif"
				document.getElementById("date").style.fontFamily = "Arvo, serif"
				console.log("Font is now Arvo")
				font = 3
			} else if (loadFont == "Sl") {
				document.getElementById("time").style.fontFamily = "Staatliches, cursive"
				document.getElementById("date").style.fontFamily = "Staatliches, cursive"
				console.log("Font is now Staatliches")
				font = 4
			} else if (loadFont == "Mc") {
				document.getElementById("time").style.fontFamily = "MinecraftiaRegular, cursive"
				document.getElementById("date").style.fontFamily = "MinecraftiaRegular, cursive"
				console.log("Font is now Minecraftia")
				font = 5
			} else if (loadFont == "Cv") {
				document.getElementById("time").style.fontFamily = "Caveat, cursive"
				document.getElementById("date").style.fontFamily = "Caveat, cursive"
				console.log("Font is now Caveat")
				font = 6
			} else if (loadFont == "Sm") {
				document.getElementById("time").style.fontFamily = "Sacramento, cursive"
				document.getElementById("date").style.fontFamily = "Sacramento, cursive"
				console.log("Font is now Sacramento")
				font = 7
			} else if (loadFont == "PM") {
				document.getElementById("time").style.fontFamily = "IBM Plex Mono, monospace"
				document.getElementById("date").style.fontFamily = "IBM Plex Mono, monospace"
				console.log("Font is now IBM Plex Mono")
				font = 8
			} else if (loadFont == "FC") {
				document.getElementById("time").style.fontFamily = "Fira Code, monospace"
				document.getElementById("date").style.fontFamily = "Fira Code, monospace"
				console.log("Font is now Fira Code")
				font = 9
			} else {
				document.getElementById("time").style.fontFamily = "Open Sans, sans-serif"
				document.getElementById("date").style.fontFamily = "Open Sans, sans-serif"
				console.log("Font is now the default (Open Sans)")
				font = 0		
			}
			const loadCustomFont = queryString.get('customfont')
			if (loadCustomFont != null) {
				WebFont.load({
					google: {
						families: [`${loadCustomFont}:400`]
					},
					inactive: function () {
						WebFontError()
					},
				});
				document.getElementById("time").style.fontFamily = `${loadCustomFont}, sans-serif`
				document.getElementById("date").style.fontFamily = `${loadCustomFont}, sans-serif`
				CustomFont = loadCustomFont
				font = "custom"
				console.log(`Font is now a custom font. (${loadCustomFont}) Fonts loaded with WebFontLoader`)
			}

			const loadTextColor = queryString.get('textcolor')
			console.log(`loadTextColor: ${loadTextColor}`)
			if (loadTextColor == null || loadTextColor == "") {
				console.log("No text color imported!")
			} else {
				var reg = /^([0-9a-f]{3}){1,2}$/i
				if (reg.test(loadTextColor) == true) {
					TextColor = `#${loadTextColor}`
					document.getElementById("time").style.color = TextColor
					document.getElementById("date").style.color = TextColor
					if(tinycolor(TextColor).isLight() == true) {
						document.getElementsByClassName("icon")[1].style.color = pSBC(-0.05, TextColor);
						document.getElementsByClassName("icon")[2].style.color = pSBC(-0.05, TextColor);
					} else {
						document.getElementsByClassName("icon")[1].style.color = pSBC(0.05, TextColor);
						document.getElementsByClassName("icon")[2].style.color = pSBC(0.05, TextColor);
					}
				} else {
					document.getElementById("copyConfirm").innerHTML = `That is not a valid hex color! <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span>`
					document.getElementById("copyConfirm").classList.remove("hideText")
					document.getElementById("copyConfirm").classList.add("slide-in")
					TextColor = "#000"
				}
			}

			const loadBGColor = queryString.get('bgcolor')
			if (loadBGColor == null || loadBGColor == "") {
				console.log("No background color imported!")
			} else {
				var reg = /^([0-9a-f]{3}){1,2}$/i
				if (reg.test(loadBGColor) == true) {
					BackgroundColor = `#${loadBGColor}`
					document.body.style.backgroundColor = BackgroundColor
					document.getElementsByClassName('circle')[0].style.display = "none"
					document.getElementsByClassName('circle')[1].style.display = "none"
					document.getElementsByClassName('circle')[2].style.display = "none"
					document.getElementsByClassName('circle')[3].style.display = "none"
					document.getElementsByClassName('circle')[4].style.display = "none"
					
				} else {
					document.getElementById("copyConfirm").innerHTML = `That is not a valid hex color! <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span>`
					document.getElementById("copyConfirm").classList.remove("hideText")
					document.getElementById("copyConfirm").classList.add("slide-in")
					BackgroundColor = "#000"
				}
			}

			const loadAlert = queryString.get('alert')
			if (loadAlert == null || loadAlert == "") {
				console.log("No alerts to be loaded!")
			} else {
				console.log(`Showing the following alert: ${loadAlert}`)
				document.getElementById("copyConfirm").innerHTML = `${loadAlert} <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span>`
				document.getElementById("copyConfirm").classList.remove("hideText")
				document.getElementById("copyConfirm").classList.add("slide-in")
			}
		}

		function Time() {
			now = new Date()
			if (AM_PM==false) {
				CurrentHour = now.getHours()
				CurrentMinute = now.getMinutes()
				CurrentSecond = now.getSeconds()
				if (CurrentHour <= 9) {
					CurrentHour = `0${CurrentHour}`
				} if (CurrentMinute <= 9) {
					CurrentMinute = `0${CurrentMinute}`
				} if (CurrentSecond <= 9) {
					CurrentSecond = `0${CurrentSecond}`
				}
				document.getElementById("time").innerText = `${CurrentHour}:${CurrentMinute}:${CurrentSecond}`
			} else {
				document.getElementById("time").innerText = formatAMPM(new Date)
			}
		}

		function UpdateDay() {
			now = new Date()
			thisDay = now.getDate()
			thisMonth = now.getMonth() + 1
			thisYear = now.getFullYear()
			document.getElementById("dateContent").innerText = `${thisDay}-${thisMonth}-${thisYear}`
		}

		function formatAMPM(date) {
			var hours = date.getHours();
			var minutes = date.getMinutes();
			var ampm = hours >= 12 ? 'pm' : 'am';
			hours = hours % 12;
			hours = hours ? hours : 12;
			minutes = minutes < 10 ? '0' + minutes : minutes;
			seconds = date.getSeconds()
			if (seconds <= 9) {
				seconds = `0${seconds}`
			}
			var strTime = hours + ':' + minutes + ':' + seconds + ' ' + ampm;
			return strTime;
		}

		function changeTimeFormat() {
			if (AM_PM==false) {
				AM_PM = true
				document.getElementById("clock").classList.remove('far')
				document.getElementById("clock").classList.add('fas')
				Time()
				console.log("Now showing 12 hour time format!")
			} else {
				AM_PM = false
				document.getElementById("clock").classList.add('far')
				document.getElementById("clock").classList.remove('fas')
				Time()
				console.log("Now showing 24 hour time format!")
			}
		}

		function changeColor(LocalColor) {
			if (LocalColor == "red") {
				color = "red"
				document.body.classList.add("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Changed style to red!")
			} else if (LocalColor == "yellow") {
				color = "yellow"
				document.body.classList.remove("red")
				document.body.classList.add("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Changed style to yellow!")
			} else if (LocalColor == "green") {
				color = "green"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.add("green")
				document.body.classList.remove("blue")
				console.log("Changed style to green!")
			} else if (LocalColor == "blue") {
				color = "blue"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.add("blue")
				console.log("Changed style to blue!")
			} else if (LocalColor == "white") {
				color = "white"
				document.body.classList.remove("red")
				document.body.classList.remove("yellow")
				document.body.classList.remove("green")
				document.body.classList.remove("blue")
				console.log("Reset style!")
			}
		}

		function changeFont() {
			if (font==0) {
				document.getElementById("time").style.fontFamily = "Smooch Sans, sans-serif"
				document.getElementById("date").style.fontFamily = "Smooch Sans, sans-serif"
				console.log("Font is now Smooch Sans")
				font++
			} else if (font == 1) {
				document.getElementById("time").style.fontFamily = "Playfair Display, sans-serif"
				document.getElementById("date").style.fontFamily = "Playfair Display, sans-serif"
				console.log("Font is now Playfair Display")
				font++
			} else if (font == 2) {
				document.getElementById("time").style.fontFamily = "Arvo, serif"
				document.getElementById("date").style.fontFamily = "Arvo, serif"
				console.log("Font is now Arvo")
				font++
			} else if (font == 3) {
				document.getElementById("time").style.fontFamily = "Staatliches, cursive"
				document.getElementById("date").style.fontFamily = "Staatliches, cursive"
				console.log("Font is now Staatliches")
				font++
			} else if (font == 4) {
				document.getElementById("time").style.fontFamily = "MinecraftiaRegular, cursive"
				document.getElementById("date").style.fontFamily = "MinecraftiaRegular, cursive"
				console.log("Font is now Minecraftia")
				font++
			} else if (font == 5) {
				document.getElementById("time").style.fontFamily = "Caveat, cursive"
				document.getElementById("date").style.fontFamily = "Caveat, cursive"
				console.log("Font is now Caveat")
				font++
			} else if (font == 6) {
				document.getElementById("time").style.fontFamily = "Sacramento, cursive"
				document.getElementById("date").style.fontFamily = "Sacramento, cursive"
				console.log("Font is now Sacramento")
				font++
			} else if (font == 7) {
				document.getElementById("time").style.fontFamily = "IBM Plex Mono, monospace"
				document.getElementById("date").style.fontFamily = "IBM Plex Mono, monospace"
				console.log("Font is now IBM Plex Mono")
				font++
			} else if (font == 8) {
				document.getElementById("time").style.fontFamily = "Fira Code, monospace"
				document.getElementById("date").style.fontFamily = "Fira Code, monospace"
				console.log("Font is now Fira Code")
				font++
			} else if (font == 9) {
				document.getElementById("time").style.fontFamily = "Open Sans, sans-serif"
				document.getElementById("date").style.fontFamily = "Open Sans, sans-serif"
				console.log("Font is now reset (Open Sans)")
				font = 0
			}
		}

		function share() {
			if (AM_PM==true) {
				ShareURL_1 = "?time=12"
			} else {
				ShareURL_1 = "?time=24"
			}

			if (color=="red") {
				ShareURL_2 = "&bg=r"
			} else if (color == "yellow") {
				ShareURL_2 = "&bg=y"
			} else if (color == "green") {
				ShareURL_2 = "&bg=g"
			} else if (color == "blue") {
				ShareURL_2 = "&bg=b"
			} else {
				const queryString = new URLSearchParams(window.location.search)
				const loadBGColor = queryString.get('bgcolor')
				var reg = /^([0-9a-f]{3}){1,2}$/i
				if (reg.test(loadBGColor) == true) {
					ShareURL_2 = `&bgcolor=${loadBGColor}`

					const loadTextColor = queryString.get('textcolor')
					var reg = /^([0-9a-f]{3}){1,2}$/i
					if (reg.test(loadTextColor) == true) {
						ShareURL_2 = `&bgcolor=${loadBGColor}&textcolor=${loadTextColor}`
					}
				} else {
					ShareURL_2 = "&bg=w"
				}
			}

			if (font==0) {
				ShareURL_3 = "&font=OS"
			} else if (font==1) {
				ShareURL_3 = "&font=SS"
			} else if (font == 2) {
				ShareURL_3 = "&font=PD"
			} else if (font == 3) {
				ShareURL_3 = "&font=Av"
			} else if (font == 4) {
				ShareURL_3 = "&font=Sl"
			} else if (font == 5) {
				ShareURL_3 = "&font=Mc"
			} else if (font == 6) {
				ShareURL_3 = "&font=Cv"
			} else if (font == 7) {
				ShareURL_3 = "&font=Sm"
			} else if (font == 8) {
				ShareURL_3 = "&font=PM"
			} else if (font == 9) {
				ShareURL_3 = "&font=FC"
			} else if (font == "custom") {
				ShareURL_3 = `&customfont=${CustomFont}`
			}
			// alert(`${BaseURL}${ShareURL_1}${ShareURL_2}${ShareURL_3}`)
			copy(`${BaseURL}${ShareURL_1}${ShareURL_2}${ShareURL_3}`)
		}

		function WebFontError() {
			document.getElementById("copyConfirm").innerHTML = `Could not load custom font! <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span>`
			document.getElementById("copyConfirm").classList.remove("hideText")
			document.getElementById("copyConfirm").classList.add("slide-in")
		}

		function copy(text) {
			var textField = document.createElement('textarea');
			textField.innerText = text;
			document.body.appendChild(textField);
			textField.select();
			document.execCommand('copy');
			textField.remove();
			document.getElementById("copyConfirm").innerHTML = `Copied URL! <span class="close" onclick="this.parentElement.classList.add('hideText'); this.parentElement.classList.remove('slide-in');">&times;</span>`
			document.getElementById("copyConfirm").classList.add("slide-in")
			document.getElementById("copyConfirm").classList.remove("hideText")
		}

		function wait(ms) {
			var start = new Date().getTime();
			var end = start;
			while (end < start + ms) {
				end = new Date().getTime();
			}
		}

		// Amazing code from Pimp Trizkit at https://stackoverflow.com/questions/5560248/programmatically-lighten-or-darken-a-hex-color-or-rgb-and-blend-colors
		const pSBC = (p, c0, c1, l) => {
			let r, g, b, P, f, t, h, i = parseInt, m = Math.round, a = typeof (c1) == "string";
			if (typeof (p) != "number" || p < -1 || p > 1 || typeof (c0) != "string" || (c0[0] != 'r' && c0[0] != '#') || (c1 && !a)) return null;
			if (!this.pSBCr) this.pSBCr = (d) => {
				let n = d.length, x = {};
				if (n > 9) {
					[r, g, b, a] = d = d.split(","), n = d.length;
					if (n < 3 || n > 4) return null;
					x.r = i(r[3] == "a" ? r.slice(5) : r.slice(4)), x.g = i(g), x.b = i(b), x.a = a ? parseFloat(a) : -1
				} else {
					if (n == 8 || n == 6 || n < 4) return null;
					if (n < 6) d = "#" + d[1] + d[1] + d[2] + d[2] + d[3] + d[3] + (n > 4 ? d[4] + d[4] : "");
					d = i(d.slice(1), 16);
					if (n == 9 || n == 5) x.r = d >> 24 & 255, x.g = d >> 16 & 255, x.b = d >> 8 & 255, x.a = m((d & 255) / 0.255) / 1000;
					else x.r = d >> 16, x.g = d >> 8 & 255, x.b = d & 255, x.a = -1					} return x
			};
			h = c0.length > 9, h = a ? c1.length > 9 ? true : c1 == "c" ? !h : false : h, f = this.pSBCr(c0), P = p < 0, t = c1 && c1 != "c" ? this.pSBCr(c1) : P ? { r: 0, g: 0, b: 0, a: -1 } : { r: 255, g: 255, b: 255, a: -1 }, p = P ? p * -1 : p, P = 1 - p;
			if (!f || !t) return null;
			if (l) r = m(P * f.r + p * t.r), g = m(P * f.g + p * t.g), b = m(P * f.b + p * t.b);
			else r = m((P * f.r ** 2 + p * t.r ** 2) ** 0.5), g = m((P * f.g ** 2 + p * t.g ** 2) ** 0.5), b = m((P * f.b ** 2 + p * t.b ** 2) ** 0.5);
			a = f.a, t = t.a, f = a >= 0 || t >= 0, a = f ? a < 0 ? t : t < 0 ? a : a * P + t * p : 0;
			if (h) return "rgb" + (f ? "a(" : "(") + r + "," + g + "," + b + (f ? "," + m(a * 1000) / 1000 : "") + ")";
			else return "#" + (4294967296 + r * 16777216 + g * 65536 + b * 256 + (f ? m(a * 255) : 0)).toString(16).slice(1, f ? undefined : -2)
		}
	</script>
</body>
</html>
